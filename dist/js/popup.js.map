{"version":3,"file":"popup.js","mappings":";;;;;;;;;;;;;;;;;;AAAO;AACP,sBAAsB,mCAAmC;AACzD,0CAA0C,wBAAwB;AAClE,GAAG;AACH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,YAAY,eAAe;AAC3B,YAAY,qBAAqB;AACjC,YAAY,qBAAqB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sBAAsB;AAClC,YAAY,wBAAwB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACO;AACP;AACA;AACA,kDAAkD;AAClD;AACA,kCAAkC,2BAA2B;AAC7D,6CAA6C,iBAAiB;AAC9D;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACO;AACP;AACA;AACA,kBAAkB,oBAAoB;AACtC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;;;;;;SC7HA;SACA;;SAEA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;;SAEA;SACA;;SAEA;SACA;SACA;;;;;UCtBA;UACA;UACA;UACA;UACA,yCAAyC,wCAAwC;UACjF;UACA;UACA;;;;;UCPA;;;;;UCAA;UACA;UACA;UACA,uDAAuD,iBAAiB;UACxE;UACA,gDAAgD,aAAa;UAC7D;;;;;;;;;;;;ACNgF;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,sBAAsB,uCAAuC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,iCAAiC,wBAAwB;AACzD;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,6BAA6B,6BAA6B;AAC1D;AACA;AACA;AACA;AACA;AACA,MAAM,4CAA4C;AAClD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAM,yCAAyC;AAC/C;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAM,2CAA2C;AACjD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,YAAY,qBAAqB;AACjC;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,IAAI,gEAAmB;AACvB;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA,+BAA+B,0BAA0B;AACzD;AACA;AACA;AACA,EAAE,uDAAU;AACZ;AACA;AACA;AACA,6DAA6D,cAAc;AAC3E,6DAA6D,cAAc;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,EAAE,6DAAgB;AAClB;AACA,CAAC","sources":["webpack:///./src/common_lib.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/popup.js"],"sourcesContent":["export function request_unhighlight(lemma) {\r\n  chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {\r\n    chrome.tabs.sendMessage(tabs[0].id, { wdm_unhighlight: lemma })\r\n  })\r\n}\r\n\r\nexport function make_id_suffix(text) {\r\n  const before = btoa(text)\r\n  const after = before\r\n    .replace(/\\+/g, '_')\r\n    .replace(/\\//g, '-')\r\n    .replace(/=/g, '_')\r\n  return after\r\n}\r\n\r\nexport function sync_if_needed() {\r\n  const req_keys = ['wd_last_sync', 'wd_gd_sync_enabled', 'wd_last_sync_error']\r\n  chrome.storage.local.get(req_keys, function (result) {\r\n    const { wd_last_sync } = result\r\n    const { wd_gd_sync_enabled } = result\r\n    const { wd_last_sync_error } = result\r\n    if (!wd_gd_sync_enabled || wd_last_sync_error != null) {\r\n      return\r\n    }\r\n    const cur_date = new Date()\r\n    const mins_passed = (cur_date.getTime() - wd_last_sync) / (60 * 1000)\r\n    const sync_period_mins = 30\r\n    if (mins_passed >= sync_period_mins) {\r\n      chrome.runtime.sendMessage({\r\n        wdm_request: 'gd_sync',\r\n        interactive_mode: false,\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nexport function add_lexeme(lexeme, result_handler) {\r\n  const req_keys = [\r\n    'words_discoverer_eng_dict',\r\n    'wd_idioms',\r\n    'wd_user_vocabulary',\r\n    'wd_user_vocab_added',\r\n    'wd_user_vocab_deleted',\r\n  ]\r\n  chrome.storage.local.get(req_keys, function (result) {\r\n    const dict_words = result.words_discoverer_eng_dict\r\n    const dict_idioms = result.wd_idioms\r\n    const user_vocabulary = result.wd_user_vocabulary\r\n    const { wd_user_vocab_added } = result\r\n    const { wd_user_vocab_deleted } = result\r\n    if (lexeme.length > 100) {\r\n      result_handler('bad', undefined)\r\n      return\r\n    }\r\n    lexeme = lexeme.toLowerCase()\r\n    lexeme = lexeme.trim()\r\n    if (!lexeme) {\r\n      result_handler('bad', undefined)\r\n      return\r\n    }\r\n\r\n    let key = lexeme\r\n    if (dict_words.hasOwnProperty(lexeme)) {\r\n      const wf = dict_words[lexeme]\r\n      if (wf) {\r\n        const [first] = wf\r\n        key = first\r\n      }\r\n    } else if (dict_idioms.hasOwnProperty(lexeme)) {\r\n      const wf = dict_idioms[lexeme]\r\n      if (wf && wf !== -1) {\r\n        key = wf\r\n      }\r\n    }\r\n\r\n    if (user_vocabulary.hasOwnProperty(key)) {\r\n      result_handler('exists', key)\r\n      return\r\n    }\r\n\r\n    const new_state = { wd_user_vocabulary: user_vocabulary }\r\n\r\n    user_vocabulary[key] = 1\r\n    if (typeof wd_user_vocab_added !== 'undefined') {\r\n      wd_user_vocab_added[key] = 1\r\n      new_state.wd_user_vocab_added = wd_user_vocab_added\r\n    }\r\n    if (typeof wd_user_vocab_deleted !== 'undefined') {\r\n      delete wd_user_vocab_deleted[key]\r\n      new_state.wd_user_vocab_deleted = wd_user_vocab_deleted\r\n    }\r\n\r\n    chrome.storage.local.set(new_state, function () {\r\n      sync_if_needed()\r\n      result_handler('ok', key)\r\n    })\r\n  })\r\n}\r\n\r\nexport function make_hl_style(hl_params) {\r\n  if (!hl_params.enabled) return undefined\r\n  let result = ''\r\n  if (hl_params.bold) result += 'font-weight:bold;'\r\n  if (hl_params.useBackground)\r\n    result += `background-color:${hl_params.backgroundColor};`\r\n  if (hl_params.useColor) result += `color:${hl_params.color};`\r\n  if (!result) return undefined\r\n  result += 'font-size:inherit;display:inline;'\r\n  return result\r\n}\r\n\r\nexport function localizeHtmlPage() {\r\n  // Localize by replacing __MSG_***__ meta tags\r\n  const objects = document.getElementsByTagName('html')\r\n  for (let j = 0; j < objects.length; j++) {\r\n    const obj = objects[j]\r\n    const valStrH = obj.innerHTML.toString()\r\n    const valNewH = valStrH.replace(/__MSG_(\\w+)__/g, function (match, v1) {\r\n      return v1 ? chrome.i18n.getMessage(v1) : ''\r\n    })\r\n    if (valNewH !== valStrH) {\r\n      obj.innerHTML = valNewH\r\n    }\r\n  }\r\n}\r\n\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { add_lexeme, request_unhighlight, localizeHtmlPage } from './common_lib'\r\n\r\nlet dict_size = null\r\nlet enabled_mode = true\r\n\r\nfunction display_mode() {\r\n  chrome.tabs.query(\r\n    {\r\n      active: true,\r\n      lastFocusedWindow: true,\r\n    },\r\n    function (tabs) {\r\n      const tab = tabs[0]\r\n      const url = new URL(tab.url)\r\n      const domain = url.hostname\r\n      document.getElementById('addHostName').textContent = domain\r\n      if (enabled_mode) {\r\n        document.getElementById('rb_enabled').checked = true\r\n        document.getElementById('addToListLabel').textContent =\r\n          chrome.i18n.getMessage('addSkippedLabel')\r\n        document.getElementById('addToListLabel').href =\r\n          chrome.runtime.getURL('black_list.html')\r\n        chrome.storage.local.get(['wd_black_list'], function (result) {\r\n          const black_list = result.wd_black_list\r\n          document.getElementById('addToList').checked =\r\n            black_list.hasOwnProperty(domain)\r\n        })\r\n      } else {\r\n        document.getElementById('rb_disabled').checked = true\r\n        document.getElementById('addToListLabel').textContent =\r\n          chrome.i18n.getMessage('addFavoritesLabel')\r\n        document.getElementById('addToListLabel').href =\r\n          chrome.runtime.getURL('white_list.html')\r\n        chrome.storage.local.get(['wd_white_list'], function (result) {\r\n          const white_list = result.wd_white_list\r\n          document.getElementById('addToList').checked =\r\n            white_list.hasOwnProperty(domain)\r\n        })\r\n      }\r\n    },\r\n  )\r\n}\r\n\r\nfunction process_checkbox() {\r\n  const checkboxElem = document.getElementById('addToList')\r\n  chrome.tabs.query({ active: true, lastFocusedWindow: true }, function (tabs) {\r\n    const tab = tabs[0]\r\n    const url = new URL(tab.url)\r\n    const domain = url.hostname\r\n    document.getElementById('addHostName').textContent = domain\r\n    const list_name = enabled_mode ? 'wd_black_list' : 'wd_white_list'\r\n    chrome.storage.local.get([list_name], function (result) {\r\n      const site_list = result[list_name]\r\n      if (checkboxElem.checked) {\r\n        site_list[domain] = 1\r\n      } else {\r\n        delete site_list[domain]\r\n      }\r\n      chrome.storage.local.set({ [list_name]: site_list }, function () {\r\n        display_mode()\r\n      })\r\n    })\r\n  })\r\n}\r\n\r\nfunction process_mode_switch() {\r\n  if (document.getElementById('rb_enabled').checked) {\r\n    enabled_mode = true\r\n  } else if (document.getElementById('rb_disabled').checked) {\r\n    enabled_mode = false\r\n  }\r\n  chrome.storage.local.set({ wd_is_enabled: enabled_mode })\r\n  display_mode()\r\n}\r\n\r\nfunction process_show() {\r\n  chrome.tabs.create(\r\n    { url: chrome.runtime.getURL('display.html') },\r\n    function (tab) {\r\n      // opens import dialog in new tab\r\n    },\r\n  )\r\n}\r\n\r\nfunction process_help() {\r\n  chrome.tabs.create(\r\n    { url: chrome.runtime.getURL('help.html') },\r\n    function (tab) {\r\n      // opens import dialog in new tab\r\n    },\r\n  )\r\n}\r\n\r\nfunction process_adjust() {\r\n  chrome.tabs.create(\r\n    { url: chrome.runtime.getURL('adjust.html') },\r\n    function (tab) {\r\n      // opens adjust dialog in new tab\r\n    },\r\n  )\r\n}\r\n\r\nfunction display_vocabulary_size() {\r\n  chrome.storage.local.get(['wd_user_vocabulary'], function (result) {\r\n    const { wd_user_vocabulary } = result\r\n    const vocab_size = Object.keys(wd_user_vocabulary).length\r\n    document.getElementById('vocabIndicator').textContent = vocab_size\r\n  })\r\n}\r\n\r\nfunction popup_handle_add_result(report, lemma) {\r\n  if (report === 'ok') {\r\n    request_unhighlight(lemma)\r\n    display_vocabulary_size()\r\n    document.getElementById('addText').value = ''\r\n    document.getElementById('addOpResult').textContent =\r\n      chrome.i18n.getMessage('addSuccess')\r\n  } else if (report === 'exists') {\r\n    document.getElementById('addOpResult').textContent =\r\n      chrome.i18n.getMessage('addErrorDupp')\r\n  } else {\r\n    document.getElementById('addOpResult').textContent =\r\n      chrome.i18n.getMessage('addErrorBad')\r\n  }\r\n}\r\n\r\nfunction process_add_word() {\r\n  const lexeme = document.getElementById('addText').value\r\n  if (lexeme === 'dev-mode-on') {\r\n    chrome.storage.local.set({ wd_developer_mode: true })\r\n    document.getElementById('addText').value = ''\r\n    return\r\n  }\r\n  if (lexeme === 'dev-mode-off') {\r\n    chrome.storage.local.set({ wd_developer_mode: false })\r\n    document.getElementById('addText').value = ''\r\n    return\r\n  }\r\n  add_lexeme(lexeme, popup_handle_add_result)\r\n}\r\nfunction display_percents(show_percents) {\r\n  const not_showing_cnt = Math.floor((dict_size / 100.0) * show_percents)\r\n  document.getElementById('rateIndicator1').textContent = `${show_percents}%`\r\n  document.getElementById('rateIndicator2').textContent = `${show_percents}%`\r\n  document.getElementById('countIndicator').textContent = not_showing_cnt\r\n}\r\nfunction process_rate(increase) {\r\n  chrome.storage.local.get(['wd_show_percents'], function (result) {\r\n    let show_percents = result.wd_show_percents\r\n    show_percents += increase\r\n    show_percents = Math.min(100, Math.max(0, show_percents))\r\n    display_percents(show_percents)\r\n    chrome.storage.local.set({ wd_show_percents: show_percents })\r\n  })\r\n}\r\n\r\nfunction process_rate_m1() {\r\n  process_rate(-1)\r\n}\r\nfunction process_rate_m10() {\r\n  process_rate(-10)\r\n}\r\nfunction process_rate_p1() {\r\n  process_rate(1)\r\n}\r\nfunction process_rate_p10() {\r\n  process_rate(10)\r\n}\r\n\r\nfunction init_controls() {\r\n  window.onload = function () {\r\n    document\r\n      .getElementById('addToList')\r\n      .addEventListener('click', process_checkbox)\r\n    document.getElementById('adjust').addEventListener('click', process_adjust)\r\n    document.getElementById('showVocab').addEventListener('click', process_show)\r\n    document.getElementById('getHelp').addEventListener('click', process_help)\r\n    document\r\n      .getElementById('addWord')\r\n      .addEventListener('click', process_add_word)\r\n    document\r\n      .getElementById('rateM10')\r\n      .addEventListener('click', process_rate_m10)\r\n    document.getElementById('rateM1').addEventListener('click', process_rate_m1)\r\n    document.getElementById('rateP1').addEventListener('click', process_rate_p1)\r\n    document\r\n      .getElementById('rateP10')\r\n      .addEventListener('click', process_rate_p10)\r\n    document\r\n      .getElementById('rb_enabled')\r\n      .addEventListener('click', process_mode_switch)\r\n    document\r\n      .getElementById('rb_disabled')\r\n      .addEventListener('click', process_mode_switch)\r\n\r\n    document\r\n      .getElementById('addText')\r\n      .addEventListener('keyup', function (event) {\r\n        event.preventDefault()\r\n        if (event.keyCode === 13) {\r\n          process_add_word()\r\n        }\r\n      })\r\n\r\n    display_vocabulary_size()\r\n\r\n    chrome.storage.local.get(\r\n      ['wd_show_percents', 'wd_is_enabled', 'wd_word_max_rank'],\r\n      function (result) {\r\n        const show_percents = result.wd_show_percents\r\n        enabled_mode = result.wd_is_enabled\r\n        dict_size = result.wd_word_max_rank\r\n        display_percents(show_percents)\r\n        display_mode()\r\n      },\r\n    )\r\n  }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function (event) {\r\n  localizeHtmlPage()\r\n  init_controls()\r\n})\r\n"],"names":[],"sourceRoot":""}